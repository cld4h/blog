<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content=" ç›®æ ‡ è½¯ä»¶ç ´è§£\nä½¿ç”¨ apktool åŠ dex2jar é€†å‘ crackme2.apk ï¼Œå¯»æ‰¾åˆ°çˆ†ç ´ç‚¹ï¼Œä¿®æ”¹æ³¨å†Œé€»è¾‘ä»£ç ï¼Œä½¿æ³¨å†Œæœºåˆ¶å¤±æ•ˆï¼Œä½¿ç”¨ apkTool é‡æ–°æ‰“åŒ…ç”Ÿæˆapkï¼Œè¦æ±‚æ–°çš„apkå¯¹ä»»æ„å­—ç¬¦æˆåŠŸæ³¨å†Œã€‚ï¼ˆå¯ä½¿ç”¨å·¥å…·ï¼š apktool ã€ BakSmali ã€ dex2jar ã€ jd-gui ï¼‰ã€‚\n"><title>Android crack</title>
<link rel=canonical href=https://cld4h.github.io/blog/zh-cn/p/android-crack/><link rel=stylesheet href=/blog/scss/style.min.0304c6baf04e01a8fe70693791cb744d56a3578a3120a8796cefc66825aa39c7.css><meta property='og:title' content="Android crack"><meta property='og:description' content=" ç›®æ ‡ è½¯ä»¶ç ´è§£\nä½¿ç”¨ apktool åŠ dex2jar é€†å‘ crackme2.apk ï¼Œå¯»æ‰¾åˆ°çˆ†ç ´ç‚¹ï¼Œä¿®æ”¹æ³¨å†Œé€»è¾‘ä»£ç ï¼Œä½¿æ³¨å†Œæœºåˆ¶å¤±æ•ˆï¼Œä½¿ç”¨ apkTool é‡æ–°æ‰“åŒ…ç”Ÿæˆapkï¼Œè¦æ±‚æ–°çš„apkå¯¹ä»»æ„å­—ç¬¦æˆåŠŸæ³¨å†Œã€‚ï¼ˆå¯ä½¿ç”¨å·¥å…·ï¼š apktool ã€ BakSmali ã€ dex2jar ã€ jd-gui ï¼‰ã€‚\n"><meta property='og:url' content='https://cld4h.github.io/blog/zh-cn/p/android-crack/'><meta property='og:site_name' content='cld4h çš„åšå®¢'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:published_time' content='2019-06-18T00:00:00+00:00'><meta property='article:modified_time' content='2019-06-18T00:00:00+00:00'><meta property='og:image' content='https://cld4h.github.io/blog/zh-cn/p/android-crack/smali.png'><meta name=twitter:title content="Android crack"><meta name=twitter:description content=" ç›®æ ‡ è½¯ä»¶ç ´è§£\nä½¿ç”¨ apktool åŠ dex2jar é€†å‘ crackme2.apk ï¼Œå¯»æ‰¾åˆ°çˆ†ç ´ç‚¹ï¼Œä¿®æ”¹æ³¨å†Œé€»è¾‘ä»£ç ï¼Œä½¿æ³¨å†Œæœºåˆ¶å¤±æ•ˆï¼Œä½¿ç”¨ apkTool é‡æ–°æ‰“åŒ…ç”Ÿæˆapkï¼Œè¦æ±‚æ–°çš„apkå¯¹ä»»æ„å­—ç¬¦æˆåŠŸæ³¨å†Œã€‚ï¼ˆå¯ä½¿ç”¨å·¥å…·ï¼š apktool ã€ BakSmali ã€ dex2jar ã€ jd-gui ï¼‰ã€‚\n"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='https://cld4h.github.io/blog/zh-cn/p/android-crack/smali.png'></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=åˆ‡æ¢èœå•>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/blog/zh-cn/><img src=/blog/img/avataaars_hu_25972a44ed8b91a1.png width=300 height=318 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>ğŸ¡</span></figure><div class=site-meta><h1 class=site-name><a href=/blog/zh-cn>cld4h çš„åšå®¢</a></h1><h2 class=site-description>Self sufficient!</h2></div></header><ol class=menu-social><li><a href=mailto:cld4h@disroot.org target=_blank title=email rel=me><svg class="icon icon-tabler icon-tabler-email" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path d="M4 5.5s16 0 16 0c1.19.0 2 .13 2 1.5V17.5C22 18.87 21.19 19 20 19H4C2.81 19 2 18.87 2 17.5V7c0-1.37.81-1.5 2-1.5z"/><path d="M2.5 6c2 2 4 4 5.58 5.25C9.67 12.5 10.83 13 12 13s2.33-.5 3.92-1.75C17.5 10 19.5 8 21.5 6"/><path d="M8.5 12c-2 1.67-4 3.33-6 5"/><path d="M15.5 12c2 1.67 4 3.33 6 5"/></svg></a></li><li><a href=https://github.com/cld4h target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=/blog/about/#rss-links target=_blank title=RSS rel=me><svg class="icon icon-tabler icon-tabler-rss" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="5" cy="19" r="1"/><path d="M4 4a16 16 0 0116 16"/><path d="M4 11a9 9 0 019 9"/></svg></a></li><li><a href=/blog/about/#xmpp target=_blank title=xmpp:cld4h@disroot.org rel=me><svg class="icon icon-tabler icon-tabler-messages" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M21 14l-3-3h-7a1 1 0 01-1-1V4a1 1 0 011-1h9a1 1 0 011 1v10"/><path d="M14 15v2a1 1 0 01-1 1H6l-3 3V11a1 1 0 011-1h2"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/blog/blog target=_blank><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/blog/zh-cn/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>å½’æ¡£</span></a></li><li><a href=/blog/zh-cn/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>æœç´¢</span></a></li><li><a href=/blog/zh-cn/%E5%85%B3%E4%BA%8E/><svg class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>å…³äº</span></a></li><li class=menu-bottom-section><ol class=menu><li id=i18n-switch><svg class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 5h7"/><path d="M9 3v2c0 4.418-2.239 8-5 8"/><path d="M5 9c-.003 2.144 2.952 3.908 6.7 4"/><path d="M12 20l4-9 4 9"/><path d="M19.1 18h-6.2"/></svg>
<select name=language title=language onchange="window.location.href=this.selectedOptions[0].value"><option value=https://cld4h.github.io/blog/>English</option><option value=https://cld4h.github.io/blog/zh-tw/>ä¸­æ–‡æ­£é«”</option><option value=https://cld4h.github.io/blog/zh-cn/ selected>ä¸­æ–‡ç®€ä½“</option></select></li><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>æš—è‰²æ¨¡å¼</span></li></ol></li></ol></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/blog/zh-cn/p/android-crack/><img src=/blog/zh-cn/p/android-crack/smali_hu_14b1cc499f9fd221.png srcset="/blog/zh-cn/p/android-crack/smali_hu_14b1cc499f9fd221.png 800w, /blog/zh-cn/p/android-crack/smali_hu_6a8ed6227b4f859.png 1600w" width=800 height=436 loading=lazy alt="Featured image of post Android crack"></a></div><div class=article-details><div class=article-title-wrapper><h2 class=article-title><a href=/blog/zh-cn/p/android-crack/>Android crack</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Jun 18, 2019</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>é˜…è¯»æ—¶é•¿: 13 åˆ†é’Ÿ</time></div></footer></div></header><section class=article-content><div class=sect1><h2 id=_ç›®æ ‡>ç›®æ ‡</h2><div class=sectionbody><div class="olist arabic"><ol class=arabic><li><p>è½¯ä»¶ç ´è§£</p></li></ol></div><div class=paragraph><p>ä½¿ç”¨ <code>apktool</code> åŠ <code>dex2jar</code> é€†å‘ <code>crackme2.apk</code> ï¼Œå¯»æ‰¾åˆ°çˆ†ç ´ç‚¹ï¼Œä¿®æ”¹æ³¨å†Œé€»è¾‘ä»£ç ï¼Œä½¿æ³¨å†Œæœºåˆ¶å¤±æ•ˆï¼Œä½¿ç”¨ <code>apkTool</code> é‡æ–°æ‰“åŒ…ç”Ÿæˆapkï¼Œè¦æ±‚æ–°çš„apkå¯¹ä»»æ„å­—ç¬¦æˆåŠŸæ³¨å†Œã€‚ï¼ˆå¯ä½¿ç”¨å·¥å…·ï¼š <code>apktool</code> ã€ <code>BakSmali</code> ã€ <code>dex2jar</code> ã€ <code>jd-gui</code> ï¼‰ã€‚</p></div><div class="olist arabic"><ol class=arabic start=2><li><p>æ³¨å†Œæœºå¼€å‘</p></li></ol></div><div class=paragraph><p>é€†å‘ç¤ºä¾‹ç¨‹åº <code>crackme.apk</code> ï¼Œæ ¹æ® <code>dex2jar</code> å’Œ <code>JD-GUI</code> å·¥å…·ï¼ŒæŸ¥çœ‹javaæºç ï¼Œåˆ†ææ³¨å†Œæœºåˆ¶ï¼Œå†™å‡ºæ³¨å†Œæœºç¨‹åºã€‚</p></div></div></div><div class=sect1><h2 id=_ç¯å¢ƒè¯´æ˜>ç¯å¢ƒè¯´æ˜</h2><div class=sectionbody><table class="tableblock frame-all grid-all stretch"><col style=width:50%><col style=width:50%><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>å·¥å…·</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>ç‰ˆæœ¬</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>apktool</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>v2.4.0 with smali v2.2.6 and baksmali v2.2.6</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>OpenJDK</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>1.8.0_212</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>dex2jar</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>2.0</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>jd-gui</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>1.5.2</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Android Studio</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Android Studio 3.4.1</p><p class=tableblock>Build #AI-183.6156.11.34.5522156, built on May 2, 2019</p><p class=tableblock>JRE: 1.8.0_152-release-1343-b16-5323222 amd64</p><p class=tableblock>JVM: OpenJDK 64-Bit Server VM by JetBrains s.r.o</p><p class=tableblock>Linux 5.1.8-arch1-1-ARCH</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>AVD è™šæ‹Ÿæœº</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Nexus 5X API 28 x86</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>ADB</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Android Debug Bridge version 1.0.41
Version 28.0.3-5475833</p></td></tr></tbody></table></div></div><div class=sect1><h2 id=_è½¯ä»¶ç ´è§£>è½¯ä»¶ç ´è§£</h2><div class=sectionbody><div class=sect2><h3 id=_åç¼–è¯‘è¿‡ç¨‹è¯´æ˜>åç¼–è¯‘è¿‡ç¨‹è¯´æ˜</h3><div class=paragraph><p>ä½¿ç”¨ <code>apktool</code> è¿›è¡Œåç¼–è¯‘ï¼Œæ‰§è¡Œï¼š</p></div><div class=literalblock><div class=content><pre>apktool d crackme2.apk</pre></div></div><div class=paragraph><p>å¾—åˆ° <code>crackme2</code> ç›®å½•ï¼ŒæŸ¥çœ‹å…¶ä¸­æ–‡ä»¶åŠç›®å½•ç»“æ„ï¼š</p></div><div class=literalblock><div class=content><pre>cd crackme2
tree . &gt; t.txt</pre></div></div><div class=paragraph><p>è¾“å‡ºçš„ <code>t.txt</code> ä¸­å†…å®¹å¦‚ä¸‹ï¼š</p></div><div class=listingblock><div class=title>t.txt</div><div class=content><pre>.
â”œâ”€â”€ AndroidManifest.xml
â”œâ”€â”€ apktool.yml
â”œâ”€â”€ original
â”‚Â Â  â”œâ”€â”€ AndroidManifest.xml
â”‚Â Â  â””â”€â”€ META-INF
â”‚Â Â      â”œâ”€â”€ CERT.RSA
â”‚Â Â      â”œâ”€â”€ CERT.SF
â”‚Â Â      â””â”€â”€ MANIFEST.MF
â”œâ”€â”€ res
â”‚Â Â  â”œâ”€â”€ drawable-hdpi-v4
â”‚Â Â  â”‚Â Â  â””â”€â”€ icon.png
â”‚Â Â  â”œâ”€â”€ drawable-ldpi-v4
â”‚Â Â  â”‚Â Â  â””â”€â”€ icon.png
â”‚Â Â  â”œâ”€â”€ drawable-mdpi-v4
â”‚Â Â  â”‚Â Â  â””â”€â”€ icon.png
â”‚Â Â  â”œâ”€â”€ layout
â”‚Â Â  â”‚Â Â  â””â”€â”€ main.xml
â”‚Â Â  â””â”€â”€ values
â”‚Â Â      â”œâ”€â”€ ids.xml
â”‚Â Â      â”œâ”€â”€ public.xml
â”‚Â Â      â””â”€â”€ strings.xml
â”œâ”€â”€ smali
â”‚Â Â  â””â”€â”€ com
â”‚Â Â      â””â”€â”€ lohan
â”‚Â Â          â””â”€â”€ crackme0a
â”‚Â Â              â”œâ”€â”€ Main.smali
â”‚Â Â              â”œâ”€â”€ R$attr.smali
â”‚Â Â              â”œâ”€â”€ R$drawable.smali
â”‚Â Â              â”œâ”€â”€ R$id.smali
â”‚Â Â              â”œâ”€â”€ R$layout.smali
â”‚Â Â              â”œâ”€â”€ R$string.smali
â”‚Â Â              â””â”€â”€ R.smali
â””â”€â”€ t.txt

12 directories, 21 files</pre></div></div><div class=paragraph><p>å½“ä½¿ç”¨ <code>apktool</code> å·¥å…·åç¼–è¯‘ apk æ–‡ä»¶åï¼Œä¼šåœ¨åç¼–è¯‘å·¥ç¨‹ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ª <code>smali</code> ç›®å½•ï¼Œå…¶ä¸­ä¿å­˜äº†æ‰€æœ‰åç¼–è¯‘å‡ºçš„ <code>smali</code> æ–‡ä»¶ï¼Œè¿™äº›æ–‡ä»¶çš„åŠŸèƒ½æ˜¯æ ¹æ®ç¨‹åºåŒ…çš„å±‚æ¬¡ç»“æ„ç”Ÿæˆç›¸åº”çš„ç›®å½•ã€‚åœ¨ Android åº”ç”¨ç¨‹åºä¸­ï¼Œåœ¨ç¨‹åºç¼–è¯‘å‰çš„æ‰€æœ‰ Java ç±»éƒ½ä¼šåœ¨ç¼–è¯‘åçš„ç›¸åº”ç›®å½•ä¸‹ç”Ÿæˆç‹¬ç«‹çš„ <code>smali</code> æ–‡ä»¶ï¼Œæ— è®ºæ˜¯æ™®é€šç±»ã€æŠ½è±¡ç±»ã€æ¥å£ç±»æˆ–è€…å†…éƒ¨ç±»ï¼Œåœ¨åç¼–è¯‘åçš„ä»£ç ä¸­éƒ½ä»¥ç‹¬ç«‹çš„ <code>.smali</code> æ ¼å¼æ–‡ä»¶å­˜æ”¾ã€‚æ¯ä¸ª <code>.smali</code> æ ¼å¼æ–‡ä»¶éƒ½ç”±è‹¥å¹²ä»£ç è¯­å¥ç»„æˆï¼Œæ‰€æœ‰çš„ä»£ç è¯­å¥éƒ½éµå¾ªäº†ä¸¥æ ¼çš„è¯­æ³•è§„èŒƒã€‚</p></div></div><div class=sect2><h3 id=_smaliæ–‡ä»¶æ ¼å¼ä¿¡æ¯è¯´æ˜>smaliæ–‡ä»¶æ ¼å¼ä¿¡æ¯è¯´æ˜</h3><div class=paragraph><p>é€šå¸¸æ¥è¯´ï¼Œ <code>.smali</code> æ ¼å¼æ–‡ä»¶çš„å‰3è¡Œä»£ç æè¿°äº†å½“å‰ç±»çš„ä¸€äº›ä¿¡æ¯ï¼Œå…·ä½“æ ¼å¼å¦‚ä¸‹æ‰€ç¤ºï¼š</p></div><div class=literalblock><div class=content><pre>.class &lt;è®¿é—®æƒé™&gt; [ä¿®é¥°å…³é”®å­—] &lt;ç±»å&gt;
.super &lt;çˆ¶ç±»å&gt;
.source &lt;æºæ–‡ä»¶å&gt;</pre></div></div><div class=paragraph><p>ä¾‹å¦‚åœ¨ <code>Main.smali</code> æ–‡ä»¶ä¸­ï¼Œå‰ä¸‰è¡Œä¸º</p></div><div class=literalblock><div class=content><pre>.class public Lcom/lohan/crackme0a/Main;
.super Landroid/app/Activity;
.source &#34;Main.java&#34;</pre></div></div><div class=paragraph><p>ç¬¬ä¸€è¡Œä»£ç ä¸­çš„ <code>.class</code> æŒ‡ä»¤æŒ‡å®šäº†å½“å‰ç±»çš„ç±»åã€‚ç±»åå¼€å¤´çš„å­—ç¬¦â€œLâ€éµå¾ªäº† Dalvik VM å­—èŠ‚ç çš„çº¦å®šè§„åˆ™ï¼Œè¡¨ç¤ºåé¢è·Ÿéšçš„å­—ç¬¦ä¸²ä¸ºä¸€ä¸ªç±»</p></div><div class=paragraph><p>ç¬¬äºŒè¡Œä»£ç ä¸­çš„ <code>.super</code> æŒ‡ä»¤è®¾ç½®äº†å½“å‰çš„çˆ¶ç±»ï¼Œæœ¬å®ä¾‹ <code>Lcom/lohan/crackme0a/Main</code> çš„çˆ¶ç±»æ˜¯ <code>Landroid/app/Activity</code></p></div><div class=paragraph><p>ç¬¬ä¸‰è¡Œä»£ç ä¸­çš„ <code>.source</code> æŒ‡ä»¤è®¾ç½®äº†å½“å‰ç±»çš„æºæ–‡ä»¶åã€‚</p></div><div class=paragraph><p>å‰ä¸‰è¡Œä»£ç åçš„ä»£ç éƒ¨åˆ†å°±æ˜¯æ•´ä¸ªç±»çš„ä¸»é¢˜éƒ¨åˆ†ï¼Œä¸€ä¸ªAndroidç¨‹åºç±»å¯ä»¥ç”±å¤šä¸ªå­—æ®µæˆ–æ–¹æ³•ç»„æˆã€‚åœ¨ <code>smali</code> æ–‡ä»¶ä¸­ï¼Œä½¿ç”¨ <code>.field</code> æŒ‡ä»¤æ¥å£°æ˜å­—æ®µã€‚è¿™é‡Œå­—æ®µæœ‰é™æ€å­—æ®µå’Œå®ä¾‹å­—æ®µä¸¤ç§ã€‚å…·ä½“è¯´æ˜å¦‚ä¸‹æ‰€ç¤ºã€‚</p></div><div class=paragraph><p>é™æ€å­—æ®µçš„å£°æ˜æ ¼å¼å¦‚ä¸‹ï¼š</p></div><div class=literalblock><div class=content><pre># static fields
.field &lt;è®¿é—®æƒé™&gt; static [ä¿®é¥°å…³é”®å­—] &lt;å­—æ®µå&gt;:&lt;å­—æ®µç±»å‹&gt;</pre></div></div><div class=paragraph><p>å½“ <code>baksmali</code> ç”Ÿæˆ <code>smali</code> æ–‡ä»¶æ—¶ï¼Œä¼šåœ¨é™æ€å­—æ®µå£°æ˜çš„èµ·å§‹å¤„æ·»åŠ  <code>static fields</code> æ³¨é‡Šã€‚æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œåœ¨ <code>smali</code> æ–‡ä»¶ä¸­çš„æ³¨é‡Šä¸ Dalvik VM ä¸­çš„è¯­æ³•ä¸€æ ·ï¼Œéƒ½æ˜¯ä»¥â€œ#â€å¼€å¤´ã€‚åœ¨ <code>.field</code> æŒ‡ä»¤åä¼šç´§è·Ÿç€â€œè®¿é—®æƒé™â€æŒ‡ä»¤ï¼Œè¿™é‡Œçš„è®¿é—®æƒé™å¯ä»¥æ˜¯ <code>public</code> ã€ <code>private</code> ã€ <code>protected</code> ã€‚â€œä¿®é¥°å…³é”®å­—â€æè¿°äº†å­—æ®µçš„å…¶ä»–å±æ€§ï¼Œä¾‹å¦‚ <code>synthetic</code> ã€‚æŒ‡ä»¤çš„æœ€åæ˜¯ â€œå­—æ®µåâ€å’Œâ€œå­—æ®µç±»å‹â€ï¼Œä½¿ç”¨å†’å·è¿›è¡Œåˆ†éš”ï¼Œè¯­æ³•ä¸ Dalvik VM ä¸€æ ·ã€‚</p></div><div class=paragraph><p>å®ä¾‹å­—æ®µçš„å£°æ˜ä¸é™æ€å­—æ®µç±»ä¼¼ï¼Œåªæ˜¯å°‘äº† <code>static</code> å…³é”®å­—ï¼Œ å…¶å…·ä½“æ ¼å¼å¦‚ä¸‹ï¼š</p></div><div class=literalblock><div class=content><pre># instance fields
.field &lt;è®¿é—®æƒé™&gt; [ä¿®é¥°å…³é”®å­—] &lt;å­—æ®µå&gt;:&lt;å­—æ®µç±»å‹&gt;</pre></div></div><div class=paragraph><p>ç›´æ¥æ–¹æ³•çš„å£°æ˜æ ¼å¼å¦‚ä¸‹æ‰€ç¤ºï¼š</p></div><div class=literalblock><div class=content><pre># direct methods
.method &lt;è®¿é—®æƒé™&gt; [ä¿®é¥°å…³é”®å­—] &lt;æ–¹æ³•åŸå‹&gt;
  &lt;.locals&gt;
[.parameter]
[.prologue]
[.line]
&lt;ä»£ç ä½“&gt;
.end method</pre></div></div><div class="olist arabic"><ol class=arabic><li><p><code>direct methods</code> æ˜¯ <code>baksmali</code> æ·»åŠ çš„æ³¨é‡Šï¼Œè®¿é—®æƒé™å’Œä¿®é¥°å…³é”®å­—ä¸å­—æ®µçš„æè¿°ç›¸åŒï¼Œæ–¹æ³•åŸå‹æè¿°äº†æ–¹æ³•çš„åç§°ã€å‚æ•°ä¸è¿”å›å€¼</p></li><li><p><code>.locals</code> æŒ‡å®šäº†ä½¿ç”¨çš„å±€éƒ¨å˜é‡çš„ä¸ªæ•°ã€‚</p></li><li><p><code>.parameter</code> æŒ‡å®šäº†æ–¹æ³•çš„å‚æ•°ï¼Œä¸Dalvik VMè¯­æ³•ä¸­ä½¿ç”¨çš„ <code>.parameters</code> æŒ‡å®šçš„å‚æ•°ä¸ªæ•°ä¸åŒï¼Œæ¯ä¸ª <code>.parameter</code> æŒ‡ä»¤è¡¨æ˜ä½¿ç”¨ä¸€ä¸ªå‚æ•°ï¼Œå‡å¦‚åœ¨æ–¹æ³•ä¸­ä½¿ç”¨äº†3ä¸ªå‚æ•°ï¼Œé‚£ä¹ˆå°±ä¼šå‡ºç°3æ¡ <code>.parameter</code> æŒ‡ä»¤ã€‚</p></li><li><p><code>.prologue</code> æŒ‡å®šäº†ä»£ç çš„å¼€å§‹å¤„ï¼Œæ··æ·†è¿‡çš„ä»£ç å¯èƒ½å»é™¤äº†è¯¥æŒ‡ä»¤ã€‚</p></li><li><p><code>.line</code> æŒ‡å®šäº†è¯¥å¤„æŒ‡ä»¤åœ¨æºä»£ç ä¸­çš„è¡Œå·ï¼ŒåŒç†ï¼Œæ··æ·†è¿‡çš„ä»£ç å¯èƒ½å»é™¤äº†è¡Œå·ä¿¡æ¯ã€‚</p></li></ol></div><div class=paragraph><p>å£°æ˜è™šæ–¹æ³•çš„æ ¼å¼ä¸å£°æ˜ç›´æ¥æ–¹æ³•çš„ç›¸åŒï¼Œåªæ˜¯èµ·å§‹å¤„çš„æ³¨é‡Šä¸º <code>virtual methods</code> è€Œå·²ã€‚å¦‚æœæŸä¸€ä¸ªç±»å®ç°äº†æ¥å£ï¼Œåˆ™ä¼šåœ¨ <code>smali</code> æ–‡ä»¶ä¸­ä½¿ç”¨ <code>.implements</code> æŒ‡ä»¤æ¥å£°æ˜ï¼Œå…·ä½“å£°æ˜æ ¼å¼å¦‚ä¸‹æ‰€ç¤º</p></div><div class=literalblock><div class=content><pre># interfaces
. implements &lt;æ¥å£å&gt;</pre></div></div><div class=paragraph><p><code>.implements</code> æ˜¯æ¥å£å…³é”®å­—ï¼Œå…¶åçš„æ¥å£åæ˜¯ <code>DexClassDef</code> ç»“æ„ä¸­ <code>interfacesOff</code> å­—æ®µæŒ‡å®šçš„å†…å®¹ã€‚
å½“ä¸€ä¸ªç±»ä½¿ç”¨äº†æ³¨è§£æ—¶ï¼Œä¼šåœ¨ <code>smali</code> æ–‡ä»¶ä¸­ä½¿ç”¨ <code>.annotation</code> æŒ‡ä»¤è¿›è¡Œå£°æ˜ï¼Œå£°æ˜æ³¨è§£çš„è¯­æ³•æ ¼å¼å¦‚ä¸‹æ‰€ç¤ºï¼š</p></div><div class=literalblock><div class=content><pre># annotations
.annotation [æ³¨è§£å±æ€§] &lt;æ³¨è§£ç±»å&gt;
	[æ³¨è§£å­—æ®µ = å€¼]
.end annotation</pre></div></div><div class=paragraph><p>åœ¨ Android ç¨‹åºä¸­ï¼Œæ³¨è§£çš„ä½œç”¨èŒƒå›´å¯ä»¥æ˜¯ç±»ã€æ–¹æ³•æˆ–å­—æ®µã€‚å¦‚æœæ³¨è§£ä½œç”¨èŒƒå›´æ˜¯ç±»ï¼Œåˆ™ <code>.annotation</code> æŒ‡ä»¤ä¼šç›´æ¥åœ¨ <code>smali</code> æ–‡ä»¶ä¸­å®šä¹‰ã€‚å¦‚æœæ˜¯æ–¹æ³•æˆ–å­—æ®µï¼Œåˆ™ä¼šåœ¨æ–¹æ³•æˆ–å­—æ®µå®šä¹‰ä¸­åŒ…å« <code>.annotation</code> æŒ‡ä»¤ã€‚</p></div><div class="admonitionblock tip"><div class=table-wrapper><table><tbody><tr><td class=icon><div class=title>Tip</div></td><td class=content>æ›´å¤š <code>smali</code> ç›¸å…³çŸ¥è¯†ï¼Œå¯å‚é˜… Gabor Paller æ‰€å†™çš„ã€ŠDalvik opcodesã€‹ä¸€æ–‡ã€‚ <a href=http://pallergabor.uw.hu/androidblog/dalvik_opcodes.html>é“¾æ¥</a></td></tr></tbody></table></div></div></div><div class=sect2><h3 id=_ä¿®æ”¹ç ´è§£è¿‡ç¨‹è¯´æ˜>ä¿®æ”¹ç ´è§£è¿‡ç¨‹è¯´æ˜</h3><div class=paragraph><p>å›åˆ°æˆ‘ä»¬çš„ <code>crackme2.apk</code> å®ä¾‹ï¼Œç›´æ¥åˆ†æ <code>smali</code> æŒ‡ä»¤ä¸å¤ªæ–¹ä¾¿ï¼Œæˆ‘ä»¬å…ˆé€šè¿‡ <code>dex2jar</code> å·¥å…·åç¼–è¯‘å‡ºæºç ï¼Œæ–¹ä¾¿ç†è§£ç¨‹åºè¿è¡Œçš„é€»è¾‘ã€‚</p></div><div class=paragraph><p>å…ˆè§£å‹apk</p></div><div class=literalblock><div class=content><pre>unzip crackme2.apk</pre></div></div><div class=paragraph><p>åœ¨è§£å‹å‡ºçš„æ–‡ä»¶ä¸­æ‰¾åˆ° <code>classes.dex</code> æ–‡ä»¶ï¼Œè¿›è¡Œåç¼–è¯‘ã€‚</p></div><div class=literalblock><div class=content><pre>d2j-dex2jar.sh classes.dex</pre></div></div><div class=paragraph><p>ç”Ÿæˆ <code>classes-dex2jar.jar</code> æ–‡ä»¶ï¼Œç”¨ <code>jd-gui</code> å·¥å…·æ‰“å¼€åå¯ä»¥çœ‹åˆ° <code>com.lohan.crackme0a</code> åŒ…ã€‚æ‰“å¼€ <code>Main.class</code> ï¼Œå¯çœ‹åˆ°å…¶ä¸­çš„ <code>onClick()</code> å‡½æ•°</p></div><div class=imageblock><div class=content><img src=./src.png alt=onClickå‡½æ•°></div><div class=title>Figure 1. onClick()å‡½æ•°</div></div><div class=paragraph><p>ç ´è§£çš„æ–¹æ³•ä¸€ç›®äº†ç„¶ï¼šåªè¦æˆ‘ä»¬ä¸è®©ç¨‹åºè¿›å…¥åˆ°å›¾ä¸­ <code>if</code> åˆ†æ”¯å†…éƒ¨å³å¯ã€‚</p></div><div class=paragraph><p>ç ´è§£çš„å…³é”®åœ¨äº <code>if-nez</code> æŒ‡ä»¤ã€‚</p></div><div class=paragraph><p>æ‰“å¼€ <code>smali/com/lohan/crackme0a/Main.smali</code> æ–‡ä»¶ï¼Œæœç´¢ <code>if-nez</code> æŒ‡ä»¤</p></div><div class=imageblock><div class=content><img src=./smali.png alt=Main.smaliä»£ç ></div><div class=title>Figure 2. Main.smali ä»£ç </div></div><div class=paragraph><p>å°†å…‰æ ‡é€‰ä¸­é«˜äº®çš„ä»£ç è¡Œæ”¹æˆ <code>goto :cond_0</code> ï¼Œè¿™æ ·æ•´ä¸ªç ´è§£ä»£ç å·¥ä½œå°±å®Œæˆäº†ã€‚</p></div><div class=paragraph><p>å½“ä¿®æ”¹å®Œ <code>smali</code> æ–‡ä»¶çš„ä»£ç åï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥å°†ä¿®æ”¹åçš„æ–‡ä»¶é‡æ–°ç¼–è¯‘å¹¶æ‰“åŒ…æˆapkæ–‡ä»¶ã€‚ç¼–è¯‘apkæ–‡ä»¶çš„å‘½ä»¤æ ¼å¼ä¸ºï¼š</p></div><div class=literalblock><div class=content><pre>apktool b[uild] [options] [&lt;app_path&gt;] -o [&lt;out_file&gt;]</pre></div></div><div class=paragraph><p>æ‰§è¡Œï¼š</p></div><div class=literalblock><div class=content><pre>apktool b crackme2/ -o crackme2-unsigned.apk</pre></div></div><div class=paragraph><p>å› ä¸ºç°åœ¨ç¼–è¯‘ç”Ÿæˆçš„ <code>crackme2-unsigned.apk</code> æ ¼å¼è¿˜æ²¡æœ‰ç­¾åï¼Œæ‰€ä»¥ä¸èƒ½è¿›è¡Œå®‰è£…å¹¶æµ‹è¯•ï¼Œæ¥ä¸‹æ¥éœ€è¦å¯¹ apk æ–‡ä»¶è¿›è¡Œç­¾åã€‚</p></div><div class=paragraph><p>ç­¾åçš„æ–¹æ³•æœ‰å¾ˆå¤šç§ã€‚</p></div><div class=paragraph><p>å¯ä»¥é€šè¿‡ <code>signapk.jar</code> è¿›è¡Œç­¾åã€‚ <code>signapk.jar</code> å·¥å…·æ˜¯Androidæºç ç›®å½•ä¸‹çš„ <code>build/tools/signapk/Signapk.java</code> æ–‡ä»¶ä¸­å®ç°çš„ï¼Œæºç ç¼–è¯‘åå¯ä»¥åœ¨ <code>out/host/linux-x86/framework</code> ç›®å½•ä¸­æ‰¾åˆ°ã€‚ä½¿ç”¨ <code>signapk.jar</code> ç­¾åæ—¶éœ€è¦æä¾›ç­¾åæ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ Android æºç ä¸­æä¾›çš„ç­¾åæ–‡ä»¶ <code>testkey .pk8</code> å’Œ <code>testkey.x509.pem</code> è¿™ä¸¤ä¸ªæ–‡ä»¶ä½äºAndroidæºç çš„ <code>build/target/product/security</code> ç›®å½•ä¸­ã€‚</p></div><div class=paragraph><p>ä¹Ÿå¯ä»¥é€šè¿‡ <code>jarsigner</code> è¿›è¡Œç­¾åã€‚
å¯ä»¥ä½¿ç”¨ <code>keytool</code> ç”Ÿæˆè‡ªç­¾åè¯ä¹¦ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p></div><div class=literalblock><div class=content><pre>keytool -genkey -alias android.keystore -keyalg RSA -validity 20000 -keystore android.keystore</pre></div></div><div class=paragraph><p>ç„¶åä½¿ç”¨ <code>jarsigner</code> å¯¹ apk è¿›è¡Œç­¾åï¼Œå‘½ä»¤</p></div><div class=literalblock><div class=content><pre>jarsigner -verbose -keystore android.keystore -signedjar crackme2-selfsigned.apk crackme2-unsigned.apk android.keystore</pre></div></div><div class=paragraph><p>æ‰“å¼€ Android Studio ä¸­çš„AVD Managerï¼Œ å¯åŠ¨Androidè™šæ‹Ÿæœºã€‚
é€šè¿‡ <code>adb devices</code> ç¡®è®¤è®¾å¤‡å¯ç”¨ï¼Œé€šè¿‡ <code>adb install crackme2-selfsigned.apk</code> å®‰è£…</p></div><div class=paragraph><p>æ‰“å¼€appï¼ŒéªŒè¯ç ´è§£æˆåŠŸã€‚</p></div><div class="imageblock text-center"><div class=content><img src=./yz-1.png alt=è¾“å…¥ä»»æ„å­—ç¬¦ä¸²></div><div class=title>Figure 3. è¾“å…¥ä»»æ„å­—ç¬¦ä¸²</div></div><div class="imageblock text-center"><div class=content><img src=./yz-2.png alt=éªŒè¯æˆåŠŸ></div><div class=title>Figure 4. éªŒè¯æˆåŠŸ</div></div></div></div></div><div class=sect1><h2 id=_æ³¨å†Œæœºå¼€å‘>æ³¨å†Œæœºå¼€å‘</h2><div class=sectionbody><div class=sect2><h3 id=_è½¯ä»¶ç ´è§£_2>è½¯ä»¶ç ´è§£</h3><div class=paragraph><p>ç±»ä¼¼ä¹‹å‰çš„æ­¥éª¤ï¼Œé€šè¿‡ <code>unzip</code> å¾—åˆ° dex æ–‡ä»¶åé€šè¿‡ <code>dex2jar</code> å·¥å…·å¾—åˆ° jar åŒ…ï¼Œåœ¨ <code>jd-gui</code> ä¸­æŸ¥çœ‹åç¼–è¯‘å¾—åˆ°çš„æºç ã€‚</p></div><div class=paragraph><p>é€šè¿‡æœç´¢ç‰¹å®šçš„å­—ç¬¦ä¸²æ‰¾åˆ°å…³é”®å‡½æ•°ã€‚æ¯”å¦‚ï¼Œæˆ‘é€šè¿‡æœç´¢ <code>Registerd successfully\nPlease write Tutorial How Found key?!</code> å­—ç¬¦ä¸²æ‰¾åˆ°äº†å‡½æ•° <code>_check_code()</code> ï¼Œåªæœ‰å½“ <code>_check_code()</code> è¿”å›çœŸæ—¶æ‰ä¼šæœ‰æ³¨å†ŒæˆåŠŸçš„æ¶ˆæ¯æç¤ºã€‚</p></div><div class=paragraph><p>é€šè¿‡ <code>apktool</code> å·¥å…·å°† <code>crackme.apk</code> åç¼–è¯‘ï¼Œæ‰“å¼€ <code>crackme/smali/Com/zAWS/KeygenMe/main.smali</code> ï¼Œæœç´¢ <code>_check_code()</code> ï¼Œï¼ˆ1680è¡Œï¼‰ã€‚</p></div><div class=paragraph><p>é€šè¿‡åˆ†ææºç å¯ä»¥å‘ç°ï¼Œ <code>_check_code</code> å‡½æ•°ä¸­æœ‰4å¤„è¿”å› <code>false</code> æœ€åä¸€å¤„è¿”å› <code>true</code></p></div><div class=imageblock><div class=content><img src=./checkcode.png alt=_check_code()å‡½æ•°></div></div><div class=paragraph><p>å¯¹åº” <code>main.smali</code> æ–‡ä»¶ä¸­ç¬¬1809ã€1828ã€1857ã€1870è¡Œçš„ <code>goto: goto_0</code> æŒ‡ä»¤ã€‚</p></div><div class=imageblock><div class=content><img src=./goto-1.png alt=goto-1></div></div><div class=imageblock><div class=content><img src=./goto-2.png alt=goto-2></div></div><div class=imageblock><div class=content><img src=./goto-3.png alt=goto-3></div></div><div class=imageblock><div class=content><img src=./goto-4.png alt=goto-4></div></div><div class=paragraph><p>å‰ä¸‰ä¸ªåœ¨æ‰§è¡Œ <code>goto :goto_0</code> ä¹‹å‰å‡æ‰§è¡Œ <code>move v0, v5</code> ï¼ŒæŠŠ <code>v5</code> ä¸­çš„å†…å®¹å¤åˆ¶åˆ° <code>v0</code> ï¼›è€Œæœ€åä¸€ä¸ªåœ¨æ‰§è¡Œ <code>goto :goto_0</code> ä¹‹å‰æ‰§è¡Œçš„æ˜¯ <code>move v0, v6</code> ï¼ŒæŠŠ <code>v6</code> ä¸­çš„å†…å®¹å¤åˆ¶åˆ°äº† <code>v0</code></p></div><div class=paragraph><p><code>goto_0</code> å¤„çš„æŒ‡ä»¤ä»…ä»…æ˜¯è¿”å› <code>v0</code> ä¸­çš„å€¼ã€‚å¦‚å›¾ï¼š</p></div><div class=imageblock><div class=content><img src=./goto0.png alt=goto0></div></div><div class=paragraph><p>æ‰€ä»¥æˆ‘åˆ¤æ–­å‰ä¸‰ä¸ª <code>goto</code> æŒ‡ä»¤å¯¹åº”äº <code>return false</code> ï¼Œæœ€åçš„ <code>goto</code> æŒ‡ä»¤å¯¹åº”äº <code>return true</code></p></div><div class=paragraph><p>æŸ¥çœ‹ <code>v5</code> å’Œ <code>v6</code> ä¸­çš„å†…å®¹ï¼š</p></div><div class=imageblock><div class=content><img src=./v5v6.png alt=v5v6></div></div><div class=paragraph><p>æ ¹æ®ä¸Šé¢çš„åˆ†æï¼Œæˆ‘ä»¬æœ‰å……åˆ†çš„ç†ç”±è®¤ä¸ºå°† <code>v5</code> ä¸­çš„å†…å®¹æ”¹ä¸º <code>0x1</code> åï¼Œ <code>_check_code</code> å‡½æ•°å°†æ°¸è¿œè¿”å› <code>true</code> ï¼Œè¿›è€Œè¾¾åˆ°æ³¨å†ŒæˆåŠŸçš„æ•ˆæœã€‚</p></div><div class=paragraph><p>é€šå‰é¢ä¸€æ ·ï¼Œä½œäº†æ›´æ”¹åé€šè¿‡</p></div><div class=literalblock><div class=content><pre>apktool b crackme/ -o crackme-unsigned.apk</pre></div></div><div class=paragraph><p>é‡æ–°ç¼–è¯‘ï¼Œå†é€šè¿‡</p></div><div class=literalblock><div class=content><pre>jarsigner -verbose -keystore android.keystore -signedjar crackme-selfsigned.apk crackme-unsigned.apk android.keystore</pre></div></div><div class=paragraph><p>è¿›è¡Œè‡ªç­¾åã€‚é€šè¿‡</p></div><div class=literalblock><div class=content><pre>adb install crackme-selfsigned.apk</pre></div></div><div class=paragraph><p>å®‰è£…åè¿è¡ŒéªŒè¯</p></div><div class="imageblock text-center"><div class=content><img src=./crackme-selfsigned.png alt=ç ´è§£æˆåŠŸ></div><div class=title>Figure 5. ç ´è§£æˆåŠŸ</div></div></div><div class=sect2><h3 id=_æ³¨å†Œæœºå¼€å‘_2>æ³¨å†Œæœºå¼€å‘</h3><div class=paragraph><p>æ³¨å†Œæœºå¼€å‘å®è´¨ä¸Šå°±æ˜¯å°†å‰é¢æåˆ°çš„ <code>_check_code()</code> å‡½æ•°çš„æœºç†åˆ†ææ¸…æ¥šã€‚</p></div><div class=paragraph><p>é”™è¯¯çš„æ³¨å†Œç ä¼šè¿›å…¥ä½¿ç¨‹åºåœ¨ <code>_check_code()</code> æ—¶è¿›å…¥å‰4ä¸ª <code>if</code> è¯­å¥ï¼ŒæŠ˜æˆŸæ²‰æ²™ï¼›æˆ‘ä»¬è¦æƒ³åŠæ³•æ˜¯ç¨‹åºè·³è¿‡å‰å››ä¸ª <code>if</code> è¯­å¥ã€‚</p></div><div class=paragraph><p>ä¸‹é¢æˆ‘å°†ä»å¤´è‡³å°¾è¯¦ç»†åˆ†æä»£ç å†…å®¹ï¼Œåˆ†æçš„è¿‡ç¨‹ä¹Ÿæ˜¯æˆ‘æ€è€ƒå’Œå®éªŒçš„è¿‡ç¨‹ã€‚</p></div><div class=sect3><h4 id=_readfile_å‡½æ•°><code>_readfile()</code> å‡½æ•°</h4><div class=paragraph><p>å•çœ‹å¯èƒ½ä¸€å¤´é›¾æ°´ï¼Œä½†è”ç³»åé¢çš„ <code>_decrypt()</code> å‡½æ•°â€”â€”ç”±äº <code>_readfile()</code> çš„ç»“æœä¼ ç»™äº† <code>_decrypt()</code> è¿›è¡Œè§£å¯†ï¼Œæˆ‘ä»¬çŒœå…¶ä¸­åº”è¯¥æ˜¯å¯†æ–‡ã€‚</p></div><div class=listingblock><div class=title>main.java</div><div class=content><pre class="prettyprint highlight"><code data-lang=java>public static String _readfile() throws Exception {
	File file = Common.File;
	String str = (file = Common.File).getDirInternal();
	main main1 = mostCurrent;
	if (File.Exists(str, _file_name)) {// <b class=conum>(1)</b>
		File.TextReaderWrapper textReaderWrapper = new File.TextReaderWrapper();
		File file1 = Common.File;
		String str1 = (file1 = Common.File).getDirInternal();
		main main2 = mostCurrent;
		textReaderWrapper.Initialize((InputStream)File.OpenInput(str1, _file_name).getObject());// <b class=conum>(2)</b>
		str1 = textReaderWrapper.ReadLine();
		textReaderWrapper.Close();
		return str1;// <b class=conum>(3)</b>
	}
    return &#34;&#34;;
}</code></pre></div></div><div class="colist arabic"><ol><li><p>è¯»å– <code>_file_name</code> æ–‡ä»¶</p></li><li><p>æ‰“å¼€ <code>_file_name</code> æ–‡ä»¶</p></li><li><p>ä»¥å­—ç¬¦ä¸²çš„å½¢å¼è¿”å›æ–‡ä»¶å†…å®¹ã€‚</p></li></ol></div><div class=paragraph><p>æˆ‘ä»¬æœç´¢ <code>_file_name</code> ï¼Œå‘ç°å…¶è¢«èµ‹å€¼ä¸º <code>key.txt</code> ï¼Œåç»­æ­¥éª¤ä¸­æˆ‘ä»¬ä¼šé€šè¿‡ <code>adb shell</code> æ¥æŸ¥çœ‹å…¶ä¸­çš„å†…å®¹ã€‚</p></div></div><div class=sect3><h4 id=_decrypt_å‡½æ•°å’Œ_encrypt_å‡½æ•°><code>_decrypt()</code> å‡½æ•°å’Œ <code>_encrypt()</code> å‡½æ•°</h4><div class=paragraph><p><code>_decrypt()</code> å‡½æ•°ï¼Œé¡¾åæ€ä¹‰æ˜¯è¿›è¡Œè§£å¯†æ“ä½œï¼Œè§£å¯†çš„å‰ææ˜¯åŠ å¯†ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡ŒæŠŠåŠ è§£å¯†å¯¹ç…§ç€çœ‹ã€‚ç”±äºåç¼–è¯‘å‡ºçš„ä»£ç ä¾èµ–äº <code>B2A</code> åº“ï¼Œè¿™é‡Œæˆ‘æ”¾å…¥æˆ‘ä¿®æ”¹åçš„ä»£ç ã€‚</p></div><div class=paragraph><p>å…ˆçœ‹åŠ å¯†å‡½æ•°ï¼š</p></div><div class=listingblock><div class=title>main.java</div><div class=content><pre class="prettyprint highlight"><code data-lang=java>public static String _encrypt(String paramString1, String paramString2) throws Exception{
        byte[] arrayOfByte2 = _bconv.HexToBytes(_made_key());
        byte[] arrayOfByte1 = _bconv.StringToBytes(paramString1 + &#34;zAWS!&#34;, &#34;UTF8&#34;);
        CipherWrapper.KeyGeneratorWrapper keyGeneratorWrapper = new CipherWrapper.KeyGeneratorWrapper();
        CipherWrapper cipherWrapper = new CipherWrapper();
        cipherWrapper.Initialize(&#34;DES/ECB/NoPadding&#34;);
        keyGeneratorWrapper.Initialize(&#34;DES&#34;);
        keyGeneratorWrapper.KeyFromBytes(arrayOfByte2);
        arrayOfByte1 = cipherWrapper.Encrypt(arrayOfByte1, keyGeneratorWrapper.getKey(), false);
        return bytesToHex(arrayOfByte1);// <b class=conum>(1)</b>
}</code></pre></div></div><div class="colist arabic"><ol><li><p>ä¸åç¼–è¯‘çš„ä»£ç ä¸åŒï¼ŒåŸå§‹ç¨‹åºä¸­æ­¤å¤„æ˜¯å°†è§£å¯†ç»“æœå†™å…¥ <code>key.txt</code> æ–‡ä»¶ï¼Œè¿”å›ç©ºä¸²ï¼›åœ¨æˆ‘çš„æ³¨å†Œæœºä¸­å°±æ²¡å¿…è¦è¿™ä¹ˆåšäº†ã€‚</p></li></ol></div><div class=paragraph><p>æµè§ˆä»£ç å¯çŸ¥åŠ å¯†æ“ä½œä½¿ç”¨äº†ECBæ¨¡å¼çš„DESåŠ å¯†æ–¹æ¡ˆï¼Œè¿™ä¸ªæ–¹æ¡ˆçš„å®ç°æ˜¯éœ€è¦ç¬¬ä¸‰æ–¹åº“çš„ã€‚</p></div><div class=paragraph><p>åœ¨ <code>anywheresoftware.b4a.agraham.encryption</code> åŒ…ä¸­å¯ä»¥æ‰¾åˆ°å…¶ä¸­ <code>CipherWrapper</code> ç±»çš„å®ç°ã€‚</p></div><div class=paragraph><p>ç®€ä¾¿èµ·è§ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªç±»æ•´ä¸ªå¤åˆ¶ä¸€ä»½åˆ°æˆ‘ä»¬çš„æ³¨å†Œæœºé¡¹ç›®ä¸­ã€‚å…·ä½“è¿‡ç¨‹å¾ˆç®€å•ï¼Œæ³¨æ„ä¿®æ”¹åŒ…ååŠåˆ é™¤annotationå³å¯ã€‚æ­¤å¤„ä¸å†å±•ç¤ºä¿®æ”¹è¿‡åçš„å†…å®¹ã€‚</p></div><div class=paragraph><p>ä¸‹é¢æ¥çœ‹ <code>_decrypt()</code> å‡½æ•°</p></div><div class=listingblock><div class=title>main.java</div><div class=content><pre class="prettyprint highlight"><code data-lang=java>public static String _decrypt(String paramString) throws Exception {
        byte[] arrayOfByte2 = HexToBytes(_made_key());
        byte[] arrayOfByte1 = HexToBytes(paramString);
        CipherWrapper.KeyGeneratorWrapper keyGeneratorWrapper = new CipherWrapper.KeyGeneratorWrapper();
        CipherWrapper cipherWrapper = new CipherWrapper();
        cipherWrapper.Initialize(&#34;DES/ECB/NoPadding&#34;);
        keyGeneratorWrapper.Initialize(&#34;DES&#34;);
        keyGeneratorWrapper.KeyFromBytes(arrayOfByte2);
        arrayOfByte1 = cipherWrapper.Decrypt(arrayOfByte1, keyGeneratorWrapper.getKey(), false);
        return _bconv.StringFromBytes(arrayOfByte1, &#34;UTF8&#34;).substring(0, 11);// <b class=conum>(1)</b>
}</code></pre></div></div><div class="colist arabic"><ol><li><p>è¿”å›å€¼æ˜¯é•¿åº¦ä¸º11çš„å­—ç¬¦ä¸²</p></li></ol></div><div class="admonitionblock tip"><div class=table-wrapper><table><tbody><tr><td class=icon><div class=title>Tip</div></td><td class=content>æ­£ç¡®è§£å¯†åçš„ç»“æœåº”è¯¥æ˜¯æˆ‘ä»¬è¾“å…¥ <code>Activate</code> å¯¹è¯æ¡†çš„11ä½æ•°ï¼ˆå†ç»è¿‡ä¸€ä¸ªç®€å•é‡æ’åˆ—ï¼‰</td></tr></tbody></table></div></div><div class=paragraph><p>æ¯”è¾ƒåŠ å¯†ï¼Œè§£å¯†è¿‡ç¨‹ï¼Œå‘ç°ä¸¤è€…å‡éœ€è¦è°ƒç”¨ <code>_made_key()</code> å‡½æ•°ï¼Œå› è€Œæˆ‘ä»¬éœ€è¦åˆ†æ <code>_made_key()</code> å‡½æ•°</p></div></div><div class=sect3><h4 id=_made_key_å‡½æ•°><code>_made_key()</code> å‡½æ•°</h4><div class=listingblock><div class=title>åç¼–è¯‘ç»“æœ</div><div class=content><pre class="prettyprint highlight"><code data-lang=java>public static String _made_key() throws Exception {
    main main1 = mostCurrent;
    String str1 = _imei.substring(0, 2);
    main main2 = mostCurrent;
    String str2 = _imei;
    main main3 = mostCurrent;
    int i = _imei.length();
    main3 = mostCurrent;
    str2 = str2.substring(i - 2, _imei.length());
    StringBuilder stringBuilder = (new StringBuilder()).append(str1);
    main3 = mostCurrent;
    return stringBuilder.append(_mac_address).append(str2).toString();
  }</code></pre></div></div><div class=listingblock><div class=title>ä¿®æ”¹åçš„ä»£ç </div><div class=content><pre class="prettyprint highlight"><code data-lang=java>public static String _made_key() {
        String str1 = IMEI_String.substring(0, 2);
        String str2 = IMEI_String;
        int i = IMEI_String.length();
        str2 = str2.substring(i - 2, IMEI_String.length());
        StringBuilder stringBuilder = (new StringBuilder()).append(str1);
        return stringBuilder.append(MAC_String).append(str2).toString();
}</code></pre></div></div><div class=paragraph><p>è®²åˆ°è¿™é‡Œï¼Œéœ€è¦ä»‹ç»ä¸€ä¸‹æˆ‘å¼•å…¥çš„ä¸¤ä¸ªå…¨å±€å˜é‡ï¼š</p></div><div class=listingblock><div class=content><pre class="prettyprint highlight"><code data-lang=java>public static String IMEI_String;
public static String MAC_String;</code></pre></div></div><div class=paragraph><p>é¡¾åæ€ä¹‰æ˜¯IMEIæ ‡è¯†å’ŒMACåœ°å€ï¼Œå‡ä¸º <code>String</code> ç±»å‹ã€‚ä¸¤ä¸ªé‡è¦å‚æ•°çš„å–å€¼è¿‡ç¨‹åœ¨ä¸‹é¢ä¼šè¯¦ç»†ä»‹ç»ã€‚
é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘è¿˜åˆ å»äº†è«åå…¶å¦™çš„ <code>mostCurrent</code> èµ‹å€¼è¯­å¥ã€‚</p></div><div class=paragraph><p>åˆ†æå’Œä¿®æ”¹è‡³æ­¤ï¼Œæˆ‘ä»¬éœ€è¦æš‚ä¸”æ”¾æ…¢è„šæ­¥ï¼ŒéªŒè¯ä¸€ä¸‹æˆ‘ä»¬æ‰€åšçš„æ¨æ–­å’Œæ‰€ä¿®æ”¹çš„ä»£ç éƒ½æ˜¯æ­£ç¡®çš„ã€‚ä¸‹é¢æˆ‘å°†ä»¥éªŒè¯ <code>_made_key()</code> å‡½æ•°çš„æ­£ç¡®æ€§ä¸ºä¾‹ï¼Œä»‹ç»æˆ‘æ‰€ç”¨çš„è°ƒè¯•æ–¹æ³•ã€‚</p></div></div><div class=sect3><h4 id=_éªŒè¯å·¥ä½œæ‰“å°å­—ç¬¦ä¸²>éªŒè¯å·¥ä½œï¼šæ‰“å°å­—ç¬¦ä¸²</h4><div class=paragraph><p>å‰æ–‡æåˆ°ï¼Œ <code>_encrypt()</code> å‡½æ•°å°†è®¡ç®—ç»“æœå†™å…¥äº† <code>key.txt</code> æ–‡ä»¶ã€‚å›æƒ³åˆ°è€å¸ˆä¸Šè¯¾æ‰€è®²ï¼ŒAndroid åº”ç”¨å®‰è£…åèµ„æºæ–‡ä»¶ã€è¿è¡Œæ—¶æ‰€éœ€çš„ libåº“ã€å¯åŠ¨åŠ è½½çš„é…ç½®æ–‡ä»¶çš„å­˜æ”¾è·¯å¾„æ˜¯ <code>/data/data/&lt;åŒ…å></code> æˆ‘ä»¬ä¸ç¦æ€ç´¢ï¼šèƒ½ä¸èƒ½é€šè¿‡ <code>adb shell</code> æŸ¥çœ‹ <code>key.txt</code> ä¸­çš„å†…å®¹å‘¢ï¼Ÿ</p></div><div class=paragraph><p>æ‰“å¼€ Android Studio çš„ AVD Managerï¼Œå¯åŠ¨è™šæ‹Ÿæœºã€‚</p></div><div class=paragraph><p>åœ¨ç»ˆç«¯è¾“å…¥</p></div><div class=literalblock><div class=content><pre>adb root</pre></div></div><div class=paragraph><p>ä»¥rootæƒé™å¯åŠ¨adb shellï¼Œè¾“å…¥</p></div><div class=literalblock><div class=content><pre>adb shell</pre></div></div><div class=paragraph><p>è¿›å…¥æ¨¡æ‹Ÿå™¨æ‰‹æœºç»ˆç«¯ã€‚</p></div><div class=paragraph><p>åˆ‡æ¢ç›®å½•åˆ° <code>/data/data/Com.zAWS.KeygenMe</code></p></div><div class=paragraph><p><code>ls</code> åˆ—å‡ºç›®å½•åå‘ç°æœ‰ <code>files</code> æ–‡ä»¶å¤¹</p></div><div class=paragraph><p>è¿›å…¥åçœ‹åˆ° <code>key.txt</code> ï¼Œé€šè¿‡</p></div><div class=literalblock><div class=content><pre>cat key.txt</pre></div></div><div class=paragraph><p>æŸ¥çœ‹å…¶ä¸­å†…å®¹ã€‚</p></div><div class="imageblock text-center"><div class=content><img src=./key.png alt=key.txtæ–‡ä»¶></div><div class=title>Figure 6. æŸ¥çœ‹key.txtæ–‡ä»¶(å›¾æ˜¯åæˆªçš„ï¼Œå›¾ä¸­çš„å†…å®¹å…¶å®å°±æ˜¯æˆ‘è¿™å°æ‰‹æœºæˆåŠŸæ³¨å†Œçš„key)</div></div><div class="admonitionblock tip"><div class=table-wrapper><table><tbody><tr><td class=icon><div class=title>Tip</div></td><td class=content>èƒ½ä¸èƒ½åˆ©ç”¨åŒæ ·çš„æœºåˆ¶æ‰“å°å‡ºæˆ‘ä»¬æƒ³æŸ¥çœ‹çš„å­—ç¬¦ä¸²å‘¢ï¼Ÿ</td></tr></tbody></table></div></div><div class=paragraph><p>æŸ¥çœ‹ <code>main.smali</code> æ–‡ä»¶ï¼Œæ‰¾åˆ° <code>_encrypt()</code> å‡½æ•°ï¼Œå…¶ä¸­è°ƒç”¨ <code>_write2file()</code> å‡½æ•°çš„è¯­å¥å¦‚ä¸‹ï¼š</p></div><div class=literalblock><div class=content><pre>invoke-static {v0}, LCom/zAWS/KeygenMe/main;-&gt;_write2file(Ljava/lang/String;)Ljava/lang/String;</pre></div></div><div class=paragraph><p>è¯¥å‡½æ•°åªæ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼ˆä¸Šé¢çš„ <code>v0</code> ï¼‰ï¼Œè¯¥å‚æ•°æŒ‡å®šè¦æ‰“å°çš„å­—ç¬¦ä¸²ã€‚</p></div><div class=paragraph><p>ç„¶è€Œï¼Œå¦‚æœæˆ‘ä»¬ä»…ä»…åˆ©ç”¨ä¸Šé¢ä¸€æ¡è¯­å¥æ˜¯ä¸å¤Ÿçš„ã€‚å› ä¸º <code>_write2file()</code> å‡½æ•°é»˜è®¤å†™å…¥ <code>_file_name</code> æ–‡ä»¶ã€‚è€Œ <code>_file_name</code> çš„å€¼ä¸€ç›´æ˜¯ <code>key.txt</code> ã€‚</p></div><div class=paragraph><p>å› æ­¤æˆ‘ä»¬éœ€è¦æ›´æ”¹ <code>_file_name</code> çš„å€¼ã€‚å…·ä½“æ–¹æ³•ä¹Ÿæ˜¯æ‰¾åˆ° <code>main.smali</code> ä¸­çš„å¯¹åº”çš„è¯­å¥åˆ†æå…¶å„å‚æ•°å’Œæ¡ç”¨è¿‡ç¨‹ã€‚æœ€ç»ˆå¾—åˆ°äº†ä¸€ä¸ªè¡Œä¹‹æœ‰æ•ˆçš„æ–¹æ³•ï¼š</p></div><div class=listingblock><div class=title>main.smali</div><div class=content><pre class="prettyprint highlight"><code data-lang=smali>    #output _made_key -------------------------

    const-string v6, &#34;made_key.txt&#34;

    sput-object v6, LCom/zAWS/KeygenMe/main;-&gt;_file_name:Ljava/lang/String;

    invoke-static {v1}, LCom/zAWS/KeygenMe/main;-&gt;_write2file(Ljava/lang/String;)Ljava/lang/String;

    const-string v6, &#34;key.txt&#34;

    sput-object v6, LCom/zAWS/KeygenMe/main;-&gt;_file_name:Ljava/lang/String;

    #output _made_key -------------------------</code></pre></div></div><div class=paragraph><p>å‰ä¸¤æ¡å‘½ä»¤å°† <code>_file_name</code> æ”¹ä¸º <code>made_key.txt</code> ï¼Œè°ƒç”¨ <code>_write2file()</code> åå†å°† <code>_file_name</code> æ”¹å› <code>key.txt</code> ã€‚</p></div><div class=paragraph><p>æ³¨æ„ï¼Œå…¶ä¸­çš„ <code>v6</code> å¯„å­˜å™¨æ˜¯æˆ‘æ–°å¢åŠ çš„å¯„å­˜å™¨ï¼Œæ‰€ä»¥éœ€è¦å°† <code>.locals</code> å‘½ä»¤åå‚æ•°åŠ 1ã€‚</p></div><div class=paragraph><p>å°†ä¸Šè¿°ä»£ç æ·»åŠ åˆ°</p></div><div class=literalblock><div class=content><pre>invoke-static {}, LCom/zAWS/KeygenMe/main;-&gt;_made_key()Ljava/lang/String;
move-result-object v1</pre></div></div><div class=paragraph><p>ä¹‹åå³å¯æ‰“å° <code>v1</code> ä¸­çš„å†…å®¹ï¼ŒæŸ¥çœ‹ <code>_made_key()</code> è°ƒç”¨ç»“æœã€‚</p></div><div class=paragraph><p>æŒ‰ç…§ä¸Šè¿°æ–¹æ³•ä¿®æ”¹è¿‡main.smaliåé€šè¿‡å’Œå‰é¢è½¯ä»¶ç ´è§£ä¸€è‡´çš„â€œé‡æ–°æ‰“åŒ…ã€ç­¾åã€å®‰è£…â€ä¸‰æ­¥ï¼Œå³å¯è¿è¡Œè½¯ä»¶æŸ¥çœ‹ <code>_made_key()</code> è°ƒç”¨ç»“æœã€‚</p></div><div class="imageblock text-center"><div class=content><img src=./made_key.png alt=made_keyç»“æœ></div><div class=title>Figure 7. æŸ¥çœ‹ <code>_made_key()</code> è°ƒç”¨ç»“æœ</div></div><div class=paragraph><p>ä»¥ä¸Šè¿‡ç¨‹æ‰€å™è¿°çš„è°ƒè¯•æ–¹æ³•å°±æ˜¯æˆ‘è¿™æ¬¡é€†å‘è¿‡ç¨‹çš„â€œç‘å£«å†›åˆ€â€ï¼Œæ˜¯ä¿è¯æˆ‘é‡æ–°å®ç°çš„å‡½æ•°ä¸åŸç¨‹åºä¸­å®Œå…¨ä¸€è‡´çš„å…³é”®æ‰€åœ¨ã€‚</p></div></div><div class=sect3><h4 id=_imeiå’Œmacçš„è·å–>IMEIå’ŒMACçš„è·å–</h4><div class=paragraph><p>åœ¨åŸç¨‹åºä¸­ï¼ŒIMEIé€šè¿‡</p></div><div class=literalblock><div class=content><pre>_imei = (phoneId = mostCurrent._myphone).GetDeviceId();</pre></div></div><div class=paragraph><p>è·å–ï¼›MACé€šè¿‡</p></div><div class=literalblock><div class=content><pre>_mac_address = (mostCurrent._mywifi.ABGetCurrentWifiInfo()).MacAddress;</pre></div></div><div class=paragraph><p>è·å–ã€‚</p></div><div class=paragraph><p>äº‹å®ä¸Šï¼Œæˆ‘ä»¬ç”¨æˆ·éƒ½ç†ŸçŸ¥ï¼Œå¯ä»¥é€šè¿‡æ‹¨å·ç›˜è¾“å…¥â€œ*#06#â€è·å–IMEIï¼Œå¯ä»¥é€šè¿‡æŸ¥çœ‹WiFiä¿¡æ¯æ¥è·å–MACç ã€‚</p></div><div class="imageblock text-center"><div class=content><img src=./imei.png alt=è·å–IMEIï¼Œç»“æœä¸º358240051111110 width=60></div><div class=title>Figure 8. è·å–IMEIï¼Œç»“æœä¸º358240051111110</div></div><div class="imageblock text-center"><div class=content><img src=./mac.png alt=è·å–MACï¼Œç»“æœä¸º0215b2000000 width=60></div><div class=title>Figure 9. è·å–MACï¼Œç»“æœä¸º0215b2000000</div></div><div class=paragraph><p>åœ¨æˆ‘ä¸€å¼€å§‹çš„è®¾è®¡ä¸­ï¼Œç”±ç”¨æˆ·æ‰‹åŠ¨å°†IMEIå’ŒMACå†™å…¥æ³¨å†Œæœºï¼Œç‚¹å‡»â€œComputeâ€ æŒ‰é’®åè®¡ç®—å‡ºç»“æœæ˜¾ç¤ºåœ¨â€œRegCodeâ€ä¸€æ ã€‚</p></div><div class=paragraph><p>åé¢ä¸ºäº†æ›´è‡ªåŠ¨åŒ–ï¼Œæˆ‘åœ¨ç¨‹åºä¸­åŠ å…¥è‡ªåŠ¨è·å–IMEIå’ŒMACç çš„åŠŸèƒ½ã€‚</p></div><div class=sect4><h5 id=_å°æ’æ›²>å°æ’æ›²ï¼š</h5><div class=paragraph><p>åœ¨è°ƒè¯•è¿‡ç¨‹ä¸­ï¼Œæˆ‘å‘ç°åŸç¨‹åºè·å¾—çš„MACåœ°å€ä¸æ¨¡æ‹Ÿå™¨å®é™…æ˜¾ç¤ºçš„ä¸ä¸€è‡´</p></div><div class="imageblock text-center"><div class=content><img src=./check-mac.png alt=æŸ¥çœ‹åŸç¨‹åºè·å–åˆ°çš„MACåœ°å€></div><div class=title>Figure 10. æŸ¥çœ‹åŸç¨‹åºè·å–åˆ°çš„MACåœ°å€</div></div><div class=paragraph><p>ç¨‹åºè·å¾—çš„MACåœ°å€æ˜¯ <code>02:00:00:00:00:00</code> å®é™…æ˜¯ <code>02:15:b2:00:00:00</code></p></div><div class=paragraph><p>ç®€è€Œè¨€ä¹‹ï¼ŒåŸå› æ˜¯æˆ‘çš„æ¨¡æ‹Ÿå™¨ç‰ˆæœ¬é«˜äºAndroid 6.0ï¼ˆMï¼‰ç”±äºAndroid 6.0 ä¹‹åå¯¹äºç”¨æˆ·éšç§çš„ä¿æŠ¤ï¼Œå°†ä¸å†èƒ½é€šè¿‡ <code>WifiManager</code> è·å–MACï¼Œè·å–åˆ°çš„MACå°†æ˜¯å›ºå®šçš„ï¼š <code>02:00:00:00:00:00</code> ã€‚</p></div><div class=paragraph><p>è¯¦ç»†åˆ†æåŸç¨‹åºè·å–MACçš„è¿‡ç¨‹å¯ä»¥çœ‹åˆ°å®ƒæ­£æ˜¯é€šè¿‡ <code>WifiManager</code> è·å–çš„MACåœ°å€ã€‚</p></div><div class=listingblock><div class=title>ABWifi.javaä¸­çš„ABLoadWifiå‡½æ•°</div><div class=content><pre class="prettyprint highlight"><code data-lang=java>WifiInfo wifiInfo = this.wifi.getConnectionInfo();// <b class=conum>(1)</b>
    String str1 = str2;
    if (wifiInfo != null) {
      this._CurrentWifiInfo.BSSID = wifiInfo.getBSSID();
      this._CurrentWifiInfo.MacAddress = wifiInfo.getMacAddress();// <b class=conum>(2)</b>
      this._CurrentWifiInfo.FullString = wifiInfo.toString();
//...</code></pre></div></div><div class="colist arabic"><ol><li><p><code>wifi</code> æ˜¯ <code>WifiManager</code> å¯¹è±¡</p></li><li><p>é€šè¿‡ <code>WifiInfo</code> çš„ <code>getMacAddress()</code> è·å–åˆ°MACåœ°å€</p></li></ol></div><div class=paragraph><p>ä½†è¿™å…¶å®ä¹Ÿç®€åŒ–äº†æˆ‘ç¼–ç¨‹çš„éš¾åº¦ã€‚æˆ‘ä¹Ÿåªéœ€è¦é€šè¿‡ <code>WifiManager</code> è·å–MACå³å¯ï¼Œä¸ç”¨è€ƒè™‘æ›´é«˜ç‰ˆæœ¬çš„é€‚é…äº†ã€‚</p></div><div class=paragraph><p>IMEIçš„è·å–æ–¹å¼è¾ƒä¸ºç±»ä¼¼ï¼Œæ˜¯é€šè¿‡ <code>TelephonyManager</code> çš„ <code>getimei()</code> æˆ– <code>getDeviceId()</code> å‡½æ•°å¾—åˆ°çš„ã€‚ <code>getDeviceId()</code> åœ¨Android 8.0 ï¼ˆOï¼‰åŠä»¥ä¸Šå°±è¢«æ ‡æ˜å¼ƒç”¨äº†ï¼Œæ”¹ç”¨ <code>getimei()</code> å‡½æ•°ï¼Œä¸è¿‡åœ¨æ¨¡æ‹Ÿå™¨ä¸­ï¼ŒåŸç¨‹åºèƒ½å¤Ÿè·å¾—æ­£ç¡®çš„IMEIã€‚</p></div><div class="imageblock text-center"><div class=content><img src=./check-imei.png alt=æŸ¥çœ‹åŸç¨‹åºè·å–åˆ°çš„IMEIåœ°å€ width=75%></div><div class=title>Figure 11. æŸ¥çœ‹åŸç¨‹åºè·å–åˆ°çš„IMEIåœ°å€</div></div></div></div><div class=sect3><h4 id=_calculate_codes_fix_imei_åŠ_get_correct_code_å‡½æ•°><code>_calculate_codes()</code> ï¼Œ <code>_fix_imei()</code> åŠ <code>_get_correct_code()</code> å‡½æ•°</h4><div class=paragraph><p>åœ¨ <code>_check_code()</code> å‡½æ•°ä¸­ï¼Œå‡ºå»å‰é¢åˆ†æè¿‡çš„ <code>_decrypt()</code> å‡½æ•°å¤–ï¼Œå°±æ˜¯ <code>_calculate_codes()</code> ï¼Œ <code>_fix_imei()</code> åŠ <code>_get_correct_code()</code> å‡½æ•°æ„æˆäº†ä¸»è¦éƒ¨åˆ†ã€‚åˆ†æè¿‡ç¨‹ä¸å‰æ–‡ä¸­ <code>_made_key()</code> å‡½æ•°çš„åˆ†æç›¸åŒï¼šå…ˆé€šè¿‡åç¼–è¯‘çš„Javaä»£ç é‡æ–°å®ç°ä¸€éå¯¹åº”çš„å‡½æ•°ï¼Œå†åœ¨åŸç¨‹åºå’Œæ³¨å†Œæœºç¨‹åºä¸­è¾“å…¥ç›¸åŒçš„å†…å®¹è¿›è¡Œæ£€éªŒï¼ŒåŸç¨‹åºé€šè¿‡åœ¨smaliä»£ç ä¸­æ·»åŠ è°ƒè¯•è¾“å‡ºè¯­å¥åœ¨ <code>adb shell</code> ä¸­è¿›è¡Œå­—ç¬¦ä¸²çš„æŸ¥çœ‹ï¼Œæ³¨å†Œæœºè¾“å‡ºåˆ° <code>RegCode</code> å³è¾¹çš„TextViewä¸­ï¼ˆå½“æ—¶æˆªå›¾æ—¶æ˜¯TextViewï¼Œç°åœ¨æˆ‘å·²ç»æŠŠè¿™ä¸ªæ”¹æˆäº†EditTextæ–¹ä¾¿å¤åˆ¶ï¼Œä¸è¿‡è¿™äº›éƒ½æ˜¯å°ç»†èŠ‚äº†ï¼‰,è‹¥è¾“å‡ºä¸€è‡´ï¼ŒåŸºæœ¬ä¸Šå¯ä»¥åˆ¤æ–­é‡æ–°å®ç°çš„å‡½æ•°æ˜¯æ­£ç¡®çš„ã€‚</p></div><div class=paragraph><p>ä¸‹é¢è¿›è¡Œå…·ä½“åˆ†æï¼š</p></div><div class=sect4><h5 id=_decrypt_å’Œ_encrypt_å‡½æ•°çš„åˆ†ææ£€éªŒ><code>_decrypt()</code> å’Œ <code>_encrypt()</code> å‡½æ•°çš„åˆ†ææ£€éªŒã€‚</h5><div class="imageblock text-center"><div class=content><img src=./check-key-2.png alt="check key 2" width=75%></div><div class=title>Figure 12. <code>_encrypt()</code> å‡½æ•°ï¼Œæ³¨å†Œæœºæ£€éªŒè¾“å‡ºçš„è¯­å¥ï¼Œè¾“å…¥ä¸º11ä¸ª1</div></div><div class="imageblock text-center"><div class=content><img src=./check-key.png alt="check key" width=50%></div><div class=title>Figure 13. <code>_encrypt()</code> å‡½æ•°è¾“å‡ºå¯¹æ¯”</div></div><div class=paragraph><p>è¾“å‡ºçš„å†…å®¹æ˜¯ä¸€è‡´çš„ã€‚</p></div><div class="imageblock text-center"><div class=content><img src=./check-decrypt-2.png alt="check decrypt 2" width=75%></div><div class=title>Figure 14. <code>_decrypt()</code> å‡½æ•°ï¼Œæ³¨å†Œæœºæ£€éªŒè¾“å‡ºçš„è¯­å¥ï¼Œå…ˆåŠ å¯†åœ¨è§£å¯†ï¼ŒåŠ å¯†è¾“å…¥ä¸º11ä¸ª1</div></div><div class="imageblock text-center"><div class=content><img src=./check-decrypt.png alt="check decrypt" width=50%></div><div class=title>Figure 15. <code>_decrypt()</code> å‡½æ•°è¾“å‡º</div></div><div class=paragraph><p>æˆåŠŸå°†è¾“å…¥çš„å­—ç¬¦ä¸²ï¼ˆ11ä¸ª1ï¼‰è§£å¯†</p></div></div><div class=sect4><h5 id=_calculate_codes_å’Œ_fix_imei_çš„æ£€éªŒ><code>_calculate_codes()</code> å’Œ <code>_fix_imei()</code> çš„æ£€éªŒ</h5><div class=paragraph><p>ï¼ˆè¯´ä¸€ä¸ªç»†èŠ‚ï¼šåç¼–è¯‘å‡ºçš„ä»£ç ä¸­â€œcalculateâ€ä¸€è¯æ‹¼å†™é”™è¯¯ï¼Œæˆ‘åç»­åšäº†ä¿®æ”¹ï¼‰</p></div><div class="imageblock text-center"><div class=content><img src=./check-str1-2.png alt="check str1 2" width=75%></div><div class=title>Figure 16. <code>_calculate_codes(_fix_imei(true))</code> çš„ç»“æœï¼ˆå³ <code>str1</code> ï¼‰æ³¨å†Œæœºæ£€éªŒè¾“å‡ºçš„è¯­å¥</div></div><div class=paragraph><p>æ³¨æ„åˆ°æˆ‘æˆªå›¾æ—¶åŠ ä¸Šäº†å‰é¢çš„ <code>_array_p1</code> åˆå§‹åŒ–èµ‹å€¼è¯­å¥ï¼Œè¿™å¾ˆé‡è¦ï¼Œå¦åˆ™è®¡ç®—å¤±è´¥ã€‚</p></div><div class="imageblock text-center"><div class=content><img src=./check-str1.png alt="check str1" width=50%></div><div class=title>Figure 17. <code>_calculate_codes(_fix_imei(true))</code> çš„ç»“æœï¼ˆå³ <code>str1</code> ï¼‰è¾“å‡ºç»“æœå¯¹æ¯”</div></div><div class="imageblock text-center"><div class=content><img src=./check-str2-2.png alt="check str2 2" width=75%></div><div class=title>Figure 18. <code>_calculate_codes(_fix_imei(false))</code> çš„ç»“æœï¼ˆå³ <code>str2</code> ï¼‰æ³¨å†Œæœºæ£€éªŒè¾“å‡ºçš„è¯­å¥</div></div><div class="imageblock text-center"><div class=content><img src=./check-str2.png alt="check str2" width=50%></div><div class=title>Figure 19. <code>_calculate_codes(_fix_imei(false))</code> çš„ç»“æœï¼ˆå³ <code>str2</code> ï¼‰è¾“å‡ºç»“æœå¯¹æ¯”</div></div><div class="imageblock text-center"><div class=content><img src=./check-key_from_imei_number-2.png alt={75-width}></div><div class=title>Figure 20. key_from_imei_numberæ£€éªŒ</div></div><div class=paragraph><p>è¿™ä¸ªå­—ç¬¦ä¸²å®¹æ˜“è¢«å¿½ç•¥ï¼Œæˆ‘åœ¨ä¸‹é¢ç”¨ <code>s_imei</code> è¡¨ç¤º <code>_key_from_imei_number</code> è½¬æˆçš„å­—ç¬¦ä¸²ã€‚</p></div><div class="imageblock text-center"><div class=content><img src=./check-key_from_imei_number.png alt="check key from imei number" width=50%></div><div class=title>Figure 21. key_from_imei_numberæ£€éªŒ</div></div></div><div class=sect4><h5 id=_get_correct_code_å‡½æ•°åˆ†æ><code>_get_correct_code()</code> å‡½æ•°åˆ†æ</h5><div class=listingblock><div class=content><pre class="prettyprint highlight"><code data-lang=java>public static String _get_correct_code(String paramString){
        String str1 = paramString.substring(0, 5);//0,1,2,3,4
        String str2 = paramString.substring(paramString.length() - 5);//6,7,8,9,10
        paramString = paramString.substring(5, 6);//5
        return paramString + str2 + str1;//5,6,7,8,9,10,0,1,2,3,4
}</code></pre></div></div><div class=paragraph><p>è¿™ä¸ªå‡½æ•°éå¸¸ç®€å•ï¼Œä¸€ç›®äº†ç„¶ï¼Œå°±æ˜¯å°†è¾“å…¥çš„å­—ç¬¦ä¸²ï¼ˆ <code>str3</code> ,é•¿åº¦æ˜¯11ï¼‰ä»ç¬¬å…­ä¸ªå­—ç¬¦ï¼ˆä¸‹æ ‡æ˜¯5ï¼‰å¼€å§‹ä¸€ç›´åˆ°æœ€åä¸€ä¸ªå­—ç¬¦å½¢æˆçš„å­ä¸²æ‹¿åˆ°å‰é¢æ¥ï¼Œå³ï¼šæŒ‰ç…§ä¸‹æ ‡ä¸º5,6,7,8,9,10,0,1,2,3,4çš„é¡ºåºé‡æ–°æ’åˆ—ã€‚</p></div></div></div><div class=sect3><h4 id=_æ”¶å°¾å·¥ä½œ>æ”¶å°¾å·¥ä½œ</h4><div class=paragraph><p>åˆ†æè‡³æ­¤ï¼Œæˆ‘ä»¬çš„å·¥ä½œå·²ç»åŸºæœ¬æˆåŠŸäº†ã€‚</p></div><div class=paragraph><p>åœ¨ <code>_check_code</code> ä¸­çš„ä¸‰ä¸ªifæ¡ä»¶å‘Šè¯‰äº†æˆ‘ä»¬å¦‚ä½•ç»„åˆå‡ ä¸ªå­—ç¬¦ä¸²èƒ½æ»¡è¶³æˆåŠŸæ³¨å†Œçš„æ¡ä»¶</p></div><div class=listingblock><div class=title>_check_code() å‡½æ•°</div><div class=content><pre class="prettyprint highlight"><code data-lang=java>if (!str3.substring(0, 1).equalsIgnoreCase(stringBuilderWrapper.Append(BA.NumberToString(_key_from_imei_number)).ToString().valueOf(stringBuilderWrapper)))
	return false;
if (!str3.substring(1, 6).equalsIgnoreCase(str1))
	return false;
if (!str3.substring(str3.length() - 5, str3.length()).equalsIgnoreCase(str2))
	return false;</code></pre></div></div><div class=listingblock><div class=title>æœ€ç»ˆæˆ‘çš„æ³¨å†Œæœºæ ¸å¿ƒä»£ç </div><div class=content><pre class="prettyprint highlight"><code data-lang=java>String str1,str2,str3,s_imei;
str1 = _calculate_codes(_fix_imei(true));
str2 = _calculate_codes(_fix_imei(false));
s_imei = NumberToString(_key_from_imei_number);
str3 = s_imei+str1+str2;
str3 = _recombine_code(str3);
TW_RegCodeText.setText(str3);</code></pre></div></div><div class=paragraph><p>å…¶ä¸­ <code>str3</code> ç”¨ä»¥è¡¨ç¤ºç»“æœï¼ˆå³ç”¨æˆ·åº”è¾“å…¥çš„11ä½æ•°å­—çš„æ³¨å†Œç ï¼‰ï¼Œå…¶å®ƒçš„å„å˜é‡å’Œå‡½æ•°çš„å«ä¹‰åœ¨ä¸Šé¢å‡ä»¥è¯¦ç»†è®²è¿°è¿‡äº†ã€‚</p></div><div class=paragraph><p>æœ€åçš„æ•ˆæœæ˜¯æˆåŠŸæ³¨å†Œï¼Œå°é»„é”æ‰“å¼€äº†ã€‚å›¾æˆ‘å°±ä¸ä¸Šäº†ï¼Œå› ä¸ºå’Œå‰é¢è½¯ä»¶ç ´è§£åçš„æ•ˆæœä¸€æ ·ã€‚</p></div><div class=paragraph><p>ä½†æˆ‘å½•äº†ä¸€ä¸ªå°è§†é¢‘ï¼Œ <code>success.gif</code></p></div><div class=imageblock><div class=content><img src=./success.gif alt=success.gif></div></div></div></div></div></div><div class=sect1><h2 id=_æ–‡ä»¶å¤¹å†…å®¹è¯´æ˜>æ–‡ä»¶å¤¹å†…å®¹è¯´æ˜</h2><div class=sectionbody><div class="olist arabic"><ol class=arabic><li><p><code>crackme2-selfsigned.apk</code> æ–‡ä»¶æ˜¯ç¬¬ä¸€é¢˜è½¯ä»¶ç ´è§£åè‡ªç­¾åç¨‹åº</p></li><li><p><code>Reg.apk</code> æ–‡ä»¶æ˜¯ç¬¬äºŒé¢˜çš„æ³¨å†Œæœºç¨‹åº</p></li><li><p><code>pic</code> ç›®å½•ä¸­åŒ…å«æœ¬æ–‡ä¸­çš„æ‰€æœ‰å›¾ç‰‡</p></li><li><p><code>success.gif</code> æ–‡ä»¶æ˜¯æ³¨å†Œæœºä½¿ç”¨æ•ˆæœå½•å±</p></li><li><p><code>Reg</code> ç›®å½•ä¸‹æ˜¯æ³¨å†Œæœºé¡¹ç›®æºç </p></li></ol></div></div></div></section><footer class=article-footer><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css integrity=sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js integrity=sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8 crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],ignoredClasses:["gist"]})})</script></article><footer class=site-footer><section class=copyright>&copy;
2019 -
2025 cld4h çš„åšå®¢</section><section class=powerby>ä½¿ç”¨ <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> æ„å»º<br>ä¸»é¢˜ <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.26.0>Stack</a></b> ç”± <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> è®¾è®¡</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/blog/ts/main.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>